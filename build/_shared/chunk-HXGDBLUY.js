import{a as E,c as R,e as h,f as x,j as $,k as y}from"/build/_shared/chunk-4LJTPU4C.js";import{a as z}from"/build/_shared/chunk-HEMBAUA6.js";import{a as D}from"/build/_shared/chunk-QLU6BERC.js";import{f as m}from"/build/_shared/chunk-JEBMXGTI.js";var t=m(D(),1);var H=m(D(),1);function S(r,e=globalThis?.document){let n=$(r);(0,H.useEffect)(()=>{let o=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",o),()=>e.removeEventListener("keydown",o)},[n,e])}var O="dismissableLayer.update",M="dismissableLayer.pointerDownOutside",j="dismissableLayer.focusOutside",q,Q=(0,t.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),re=(0,t.forwardRef)((r,e)=>{var n;let{disableOutsidePointerEvents:o=!1,onEscapeKeyDown:s,onPointerDownOutside:l,onFocusOutside:b,onInteractOutside:d,onDismiss:u,...v}=r,a=(0,t.useContext)(Q),[c,A]=(0,t.useState)(null),f=(n=c?.ownerDocument)!==null&&n!==void 0?n:globalThis?.document,[,N]=(0,t.useState)({}),W=R(e,i=>A(i)),g=Array.from(a.layers),[_]=[...a.layersWithOutsidePointerEventsDisabled].slice(-1),K=g.indexOf(_),C=c?g.indexOf(c):-1,U=a.layersWithOutsidePointerEventsDisabled.size>0,T=C>=K,X=Y(i=>{let p=i.target,k=[...a.branches].some(P=>P.contains(p));!T||k||(l?.(i),d?.(i),i.defaultPrevented||u?.())},f),L=G(i=>{let p=i.target;[...a.branches].some(P=>P.contains(p))||(b?.(i),d?.(i),i.defaultPrevented||u?.())},f);return S(i=>{C===a.layers.size-1&&(s?.(i),!i.defaultPrevented&&u&&(i.preventDefault(),u()))},f),(0,t.useEffect)(()=>{if(c)return o&&(a.layersWithOutsidePointerEventsDisabled.size===0&&(q=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),a.layersWithOutsidePointerEventsDisabled.add(c)),a.layers.add(c),B(),()=>{o&&a.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=q)}},[c,f,o,a]),(0,t.useEffect)(()=>()=>{c&&(a.layers.delete(c),a.layersWithOutsidePointerEventsDisabled.delete(c),B())},[c,a]),(0,t.useEffect)(()=>{let i=()=>N({});return document.addEventListener(O,i),()=>document.removeEventListener(O,i)},[]),(0,t.createElement)(h.div,E({},v,{ref:W,style:{pointerEvents:U?T?"auto":"none":void 0,...r.style},onFocusCapture:y(r.onFocusCapture,L.onFocusCapture),onBlurCapture:y(r.onBlurCapture,L.onBlurCapture),onPointerDownCapture:y(r.onPointerDownCapture,X.onPointerDownCapture)}))});function Y(r,e=globalThis?.document){let n=$(r),o=(0,t.useRef)(!1),s=(0,t.useRef)(()=>{});return(0,t.useEffect)(()=>{let l=d=>{if(d.target&&!o.current){let v=function(){F(M,n,u,{discrete:!0})},u={originalEvent:d};d.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=v,e.addEventListener("click",s.current,{once:!0})):v()}o.current=!1},b=window.setTimeout(()=>{e.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(b),e.removeEventListener("pointerdown",l),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>o.current=!0}}function G(r,e=globalThis?.document){let n=$(r),o=(0,t.useRef)(!1);return(0,t.useEffect)(()=>{let s=l=>{l.target&&!o.current&&F(j,n,{originalEvent:l},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>o.current=!0,onBlurCapture:()=>o.current=!1}}function B(){let r=new CustomEvent(O);document.dispatchEvent(r)}function F(r,e,n,{discrete:o}){let s=n.originalEvent.target,l=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(r,e,{once:!0}),o?x(s,l):s.dispatchEvent(l)}var w=m(D(),1),I=m(z(),1);var le=(0,w.forwardRef)((r,e)=>{var n;let{container:o=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...s}=r;return o?I.default.createPortal((0,w.createElement)(h.div,E({},s,{ref:e})),o):null});export{re as a,le as b};
