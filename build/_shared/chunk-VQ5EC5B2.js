import{c as p,g as N}from"/build/_shared/chunk-4LJTPU4C.js";import{a as h}from"/build/_shared/chunk-HEMBAUA6.js";import{a as E}from"/build/_shared/chunk-QLU6BERC.js";import{f as q}from"/build/_shared/chunk-JEBMXGTI.js";var e=q(E(),1),v=q(h(),1);function M(t,r){return(0,e.useReducer)((i,o)=>{let s=r[i][o];return s??i},t)}var O=t=>{let{present:r,children:i}=t,o=T(r),s=typeof i=="function"?i({present:o.isPresent}):e.Children.only(i),u=p(o.ref,s.ref);return typeof i=="function"||o.isPresent?(0,e.cloneElement)(s,{ref:u}):null};O.displayName="Presence";function T(t){let[r,i]=(0,e.useState)(),o=(0,e.useRef)({}),s=(0,e.useRef)(t),u=(0,e.useRef)("none"),$=t?"mounted":"unmounted",[l,a]=M($,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return(0,e.useEffect)(()=>{let n=f(o.current);u.current=l==="mounted"?n:"none"},[l]),N(()=>{let n=o.current,c=s.current;if(c!==t){let A=u.current,d=f(n);t?a("MOUNT"):d==="none"||n?.display==="none"?a("UNMOUNT"):a(c&&A!==d?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,a]),N(()=>{if(r){let n=m=>{let d=f(o.current).includes(m.animationName);m.target===r&&d&&(0,v.flushSync)(()=>a("ANIMATION_END"))},c=m=>{m.target===r&&(u.current=f(o.current))};return r.addEventListener("animationstart",c),r.addEventListener("animationcancel",n),r.addEventListener("animationend",n),()=>{r.removeEventListener("animationstart",c),r.removeEventListener("animationcancel",n),r.removeEventListener("animationend",n)}}else a("ANIMATION_END")},[r,a]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:(0,e.useCallback)(n=>{n&&(o.current=getComputedStyle(n)),i(n)},[])}}function f(t){return t?.animationName||"none"}export{O as a};
