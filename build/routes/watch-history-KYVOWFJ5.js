import{a as T,b as l}from"/build/_shared/chunk-HCV2RSKG.js";import{a as z}from"/build/_shared/chunk-OGE3NEVN.js";import"/build/_shared/chunk-DFIGMYQH.js";import{a as b}from"/build/_shared/chunk-MTPZRFET.js";import{a as F}from"/build/_shared/chunk-AN4HOKES.js";import{a as f}from"/build/_shared/chunk-2U5IOMZT.js";import"/build/_shared/chunk-RCF6322T.js";import{a as I}from"/build/_shared/chunk-KFQLBWY7.js";import{a as N}from"/build/_shared/chunk-FL5UVREB.js";import"/build/_shared/chunk-GBMHDDOY.js";import{a as P,d as L}from"/build/_shared/chunk-B5P4CYPT.js";import{b as D,c as k}from"/build/_shared/chunk-TQANA533.js";import"/build/_shared/chunk-E3HN6VYL.js";import{b as H}from"/build/_shared/chunk-CQDTB6KU.js";import"/build/_shared/chunk-GYMQZE7X.js";import"/build/_shared/chunk-CKU4S6GJ.js";import"/build/_shared/chunk-VRDZAOTH.js";import"/build/_shared/chunk-WQT5KMCO.js";import"/build/_shared/chunk-HEMBAUA6.js";import{a as C}from"/build/_shared/chunk-DGVX6BYT.js";import{b as S}from"/build/_shared/chunk-NYVQ56JW.js";import"/build/_shared/chunk-TLKZEMLJ.js";import"/build/_shared/chunk-UE6UC7GV.js";import{b as g,d as w,o as x,t as v}from"/build/_shared/chunk-OT3RM5IB.js";import{a as $,b as n}from"/build/_shared/chunk-QLU6BERC.js";import{f as r}from"/build/_shared/chunk-JEBMXGTI.js";var p=r($());var O=r(F());var W=r(D());var o=r(n()),G=({item:e})=>{let i=Math.round(e?.watched/e?.duration*100),s=new URL(`http://abc${e?.route}`);return e?.watched!==0&&s.searchParams.set("t",e.watched.toString()),(0,o.jsx)(x,{to:s.pathname+s.search,className:"w-[304px] sm:w-full",children:(0,o.jsx)(L,{isPressable:!0,isHoverable:!0,className:"hover:ring-2 hover:ring-primary sm:!max-h-[171px] sm:w-full",children:(0,o.jsxs)(P,{className:"flex flex-col flex-nowrap justify-start overflow-hidden p-0 sm:flex-row",children:[(0,o.jsx)(k,{width:"304px",height:"171px",src:e?.poster||b,alt:e?.title,title:e?.title,classNames:{wrapper:"z-0 m-0 min-h-[171px] min-w-[304px] overflow-hidden"},placeholder:"empty",loading:"lazy",options:{contentType:W.MimeType.WEBP},responsive:[{size:{width:304,height:171}}]}),(0,o.jsxs)("div",{className:"flex flex-col justify-start p-3",children:[(0,o.jsx)("h4",{className:"line-clamp-1",children:e?.title}),e?.season?(0,o.jsxs)("p",{children:["SS ",e.season,"\u2002-\u2002"]}):null,e?.episode?(0,o.jsxs)("p",{children:["EP ",e.episode.split("-").at(-1)]}):null,(0,o.jsx)("p",{children:new Date(e?.updated_at.toString()).toLocaleString()})]}),i>5?(0,o.jsx)(z,{size:"xs",value:i,color:"primary",className:"!absolute bottom-0 w-full"}):null]})})})},B=G;var t=r(n()),_={breadcrumb:()=>(0,t.jsx)(S,{to:"/watch-history",children:"History"},"watch-history"),getSitemapEntries:()=>null,miniTitle:()=>({title:"History",showImage:!1})},Q=C(()=>[{title:"Sora - Watch History"},{name:"description",content:"Watch History"},{property:"og:title",content:"Sora - Watch History"},{property:"og:description",content:"Watch History"},{name:"twitter:title",content:"Sora - Watch History"},{name:"twitter:description",content:"Watch History"}]);var Y=()=>{let{histories:e,page:i,totalPage:s}=v(),R=N("(max-width: 650px)",{initializeWithValue:!1}),y=w(),j=g(),m=new URLSearchParams(j.search),[c,E]=(0,p.useState)(m.get("types")?.split(",")||[]),[d,M]=(0,p.useState)(m.get("from")),[h,U]=(0,p.useState)(m.get("to")),V=()=>{let a=new URLSearchParams;[1,2].includes(c?.length)&&a.append("types",c?.join(",")),d&&a.append("from",d),h&&a.append("to",h),y(`/watch-history?${a.toString()}`)},A=a=>{let u=new URL(document.URL);u.searchParams.set("page",a.toString()),y(`${u.pathname}${u.search}`)};return(0,t.jsxs)("div",{className:"flex w-full flex-col justify-start gap-6 px-3 sm:px-0",children:[(0,t.jsx)("h2",{children:"Your watch history"}),(0,t.jsxs)("div",{className:"flex flex-row flex-wrap items-center justify-start gap-6",children:[(0,t.jsxs)(T,{label:"Select media types",orientation:"horizontal",color:"primary",defaultValue:c,onChange:a=>E(a),children:[(0,t.jsx)(l,{value:"movie",children:"Movie"}),(0,t.jsx)(l,{value:"tv",children:"TV Show"}),(0,t.jsx)(l,{value:"anime",children:"Anime"})]}),(0,t.jsxs)("div",{className:"flex gap-x-2",children:[(0,t.jsx)(f,{label:"From",type:"date",placeholder:"Enter your date",value:d||void 0,onValueChange:M}),(0,t.jsx)(f,{label:"To",type:"date",placeholder:"Enter your date",value:h||void 0,onValueChange:U})]})]}),(0,t.jsx)(H,{type:"button",color:"primary",size:"md",onPress:V,className:"w-48",children:"Search History"}),(0,t.jsx)("div",{className:"grid w-full grid-cols-1 justify-items-center gap-4 xl:grid-cols-2",children:e.map(a=>(0,t.jsx)(B,{item:a},a.id))}),s>1?(0,t.jsx)("div",{className:"mt-7 flex justify-center",children:(0,t.jsx)(I,{total:s,initialPage:i,onChange:A,...R&&{size:"xs"}})}):null]})},J=Y;export{J as default,_ as handle,Q as meta};
